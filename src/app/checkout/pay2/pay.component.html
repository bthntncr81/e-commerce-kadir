<div *ngIf="!(onProcess&&html)" class="container   ">
  <form *ngIf="!isError&&!isReponseDone" [formGroup]="checkoutForm" (ngSubmit)="onSubmit()">

    <!-- Payment Card Section -->

    <!-- <p-stepper> -->

    <!-- <p-stepperPanel header="Alıcı Bilgileri">
        <ng-template pTemplate="content" let-prevCallback="prevCallback" let-nextCallback="nextCallback"
          let-index="index">



          <div class="d-flex flex-column justify-content-center">

            <p-card header="Alıcı Bilgileri">
              <div class="p-fluid">
                <div class="p-field mt-4">
                  <label for="buyerName">İsim</label>
                  <input pInputText id="buyerName" formControlName="name" class="form-control" />
                </div>
                <div class="p-field mt-4">
                  <label for="surname">Soyisim</label>
                  <input pInputText id="surname" formControlName="surname" class="form-control" />
                </div>
                <div class="p-field mt-4">
                  <label for="email">E-posta</label>
                  <input pInputText id="email" formControlName="emailAddress" class="form-control" />
                </div>
                <div class="p-field mt-4">
                  <label for="tc">TC Kimlik No</label>
                  <input pInputText id="tc" formControlName="taxNumber" class="form-control" />
                </div>
               <div class="p-field mt-4">
                  <label for="adres">Adres</label>
                  <textarea pInputText id="adres" formControlName="registrationAddress" class="form-control"></textarea>
                </div> 
                <div class="p-field mt-4 phone-field">
                  <label for="gsmNumber">Telefon</label>
                  <ngx-intl-tel-input [cssClass]="'custom'" [preferredCountries]="preferredCountries"
                    [enableAutoCountrySelect]="true" [enablePlaceholder]="true" [searchCountryFlag]="true"
                    [searchCountryField]="[
                    SearchCountryField.Iso2,
                    SearchCountryField.Name
                  ]" [selectFirstCountry]="false" [selectedCountryISO]="CountryISO.Turkey" [maxLength]="15"
                    [phoneValidation]="true" [separateDialCode]="separateDialCode"
                    [numberFormat]="PhoneNumberFormat.National" name="gsmNumber" formControlName="phoneNumber">
                  </ngx-intl-tel-input>

                </div>
              </div>
            </p-card>
          </div>

          <div class="d-flex pt-4 justify-content-end">
            <p-button label="Next" icon="pi pi-arrow-right" iconPos="right" (onClick)="validateStep(nextCallback)" />
          </div>
        </ng-template>
      </p-stepperPanel>
      <p-stepperPanel header="Adres">
        <ng-template pTemplate="content" let-prevCallback="prevCallback" let-index="index"
          let-nextCallback="nextCallback">
        Shipping Address Section

          <div class="row gy-4 gx-4">


            <div class="col-lg-12">

              <p-card header="Kargo  Adresi">
                <div class="p-fluid">
                  <div class="p-field mt-4">
                    <label for="shippingDescription">Adres</label>
                    <input pInputText id="shippingDescription" formControlName="addressDesc" class="form-control" />
                  </div>
                  <div class="p-field mt-4">
                    <label for="shippingZipCode">Zip Code</label>
                    <input pInputText id="shippingZipCode" formControlName="postCode" class="form-control" />
                  </div>

                  <div class="p-field mt-4">
                    <label for="billingCountry">Ülke</label>
                    <p-dropdown (onChange)="changeCities($event,1)" formControlName="country" [options]="countries"
                      optionLabel="countryName" optionValue="countryName"></p-dropdown>
                  </div>
                  <div class="p-field mt-4">
                    <label for="billingCity">Şehir</label>
                    <p-dropdown formControlName="cityName" [options]="filteredCities1"></p-dropdown>

                  </div>

                </div>
              </p-card>
            </div>
          </div>
          <div class="d-flex justify-content-end gap-4">


            <div class="flex pt-4 justify-content-end">
              <p-button label="Previous" icon="pi pi-arrow-left" iconPos="right" (onClick)="prevCallback.emit()" />
            </div>
            <div class="flex pt-4 justify-content-end">
              <p-button label="Next" icon="pi pi-arrow-right" iconPos="right" (onClick)="validateStep( nextCallback)" />
            </div>
          </div>
        </ng-template>


      </p-stepperPanel> -->
    <!-- <p-stepperPanel header="Kart Bilgileri">
        <ng-template pTemplate="content" let-prevCallback="prevCallback" let-index="index">

          <div class="d-flex flex-column justify-content-center">


          </div>
          <div class="d-flex pt-4 gap-4 justify-content-end">
            <p-button label="Previous" icon="pi pi-arrow-left" iconPos="right" (onClick)="prevCallback.emit()" />

          </div>
        </ng-template>
      </p-stepperPanel>

    </p-stepper> -->

    <div class="pay-card">
      <div class="container">
        <div class="card">
          <div class="card-inner" id="card-naber">
            <div class="front">
              <img src="https://i.ibb.co/PYss3yv/map.png" class="map-img">
              <div class="row">
                <img src="https://i.ibb.co/G9pDnYJ/chip.png" style="width: 60px;" width="60px">
                <img src="https://i.ibb.co/WHZ3nRJ/visa.png" style="width: 60px;" width="60px">
              </div>
              <div class="row card-no">
                <p>{{card4}}</p>
                <p>{{card8}}</p>
                <p>{{card12}}</p>
                <p>{{card16}}</p>

              </div>
              <div class="row card-holder">
                <p>CARD HOLDER</p>
                <p>VALID TILL</p>
              </div>
              <div class="row name">
                <p>{{name}}</p>
                <p>{{expireMonth}} / {{expireYear}}</p>
              </div>
            </div>
            <div class="back">
              <img src="https://i.ibb.co/PYss3yv/map.png" class="map-img">
              <div class="bar"></div>
              <div class="row card-cvv">
                <div>
                  <img src="https://i.ibb.co/S6JG8px/pattern.png">
                </div>
                <p>{{cvv}}</p>
              </div>
              <div class="row card-text">
                <p style="visibility: hidden;">this is a virtual card design using HTML and CSS. You can aslo design
                  something like this.</p>
              </div>
              <div class="row signature">
                <p>CUSTOMER SIGNATURE</p>
                <img src="https://i.ibb.co/WHZ3nRJ/visa.png" width="80px">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div header="Payment Card" class="d-flex justify-content-center  m-auto"
      style="width: 500px;border: 1px solid rgb(181, 180, 180);padding: 1.5rem 1.5rem;border-radius: 12px;">
      <div class="row gx-4 gy-4" st>


        <div class="mt-4">
          <label for="cardHolderName">Kart Sahibi Adı Soyadı</label>
          <input pInputText id="cardHolderName" formControlName="cardHolderName" class="form-control" />
        </div>
        <div class=" mt-4">
          <label for="cardNumber">Kart Numarası</label>
          <input appCreditCardNumberMask placeholder="4444 4444 4444 4444" pInputText id="cardNumber"
            formControlName="cardNumber" class="form-control" />
        </div>

        <div class="col-lg-6 ">
          <div class="d-flex flex-column">
            <label for="expireYear">Son Kullanma Tarihi</label>
            <input pInputText appCreditCardExpiryDateMask id="expiryYear" [(ngModel)]="expireDate"
              [ngModelOptions]="{standalone:true}" />
          </div>

        </div>
        <div class="col-lg-6">
          <div class="d-flex flex-column">


            <label for="cvc">CVC</label>
            <p-inputNumber #inputNumberElement class="cvv" [maxlength]="3" formControlName="cardCVV"></p-inputNumber>

          </div>
        </div>

        <div>
          <button pButton style="border-radius: 6px; " class=" w-100" label="Checkout" type="submit"
            icon="pi pi-credit-card" iconPos="right"></button>

        </div>


      </div>
    </div>

    <div *ngIf="installmentArray.length>0" class="text-center mt-5 mb-5 m-auto"
      style="width: 600px;border: 1px solid rgb(181, 180, 180);padding: 1rem 1.5rem;border-radius: 12px;">
      <h3>Taksit Seçenekleri </h3>
      <div *ngFor="let item of installmentArray" class="d-flex  m-auto gap-4 mt-3 mb-3 p-4 "
        style="border: 1px solid rgb(177, 177, 177); border-radius: 12px;">

        <div class="d-flex flex-column justify-content-center">
          <p-radioButton name="installment" [value]="item.count" formControlName="installment"
            inputId="installment+{{item.count}}" />
        </div>

        <div class="d-flex flex-column justify-content-center">
          <strong> Taksit Sayısı</strong>
          <span class="text-center">{{item.count}}</span>
        </div>

        <div class="d-flex flex-column justify-content-center">
          <strong> Taksit Başı Tutar </strong>
          <span class="text-center"> {{amount*((100+item.customerCostCommissionRate)/100)/item.count |
            number:'1.2-2'}}</span>
        </div>
        <div class="d-flex flex-column justify-content-center">
          <strong>Toplam Ödenecek Tutar </strong>
          <span class="text-center">{{amount*((100+item.customerCostCommissionRate)/100) | number:'1.2-2'}}</span>


        </div>

      </div>

    </div>

  </form>



  <div *ngIf="isReponseDone&&isError">
    <div class="d-flex justify-content-center mt-5">
      <i class="pi pi-times" style="color:  red; font-size: 124px;"></i>
    </div>

    <div class="mt-4" style="color:  red;font-size: 42px;display: flex ; justify-content: center;text-align: center;">
      Ödeme Alırken Bir Hata Oluştu <br>
      Bankanızla Iletişime Geçin
    </div>

  </div>

  <div *ngIf="isReponseDone&&isSuccess">
    <div class="d-flex justify-content-center mt-5">
      <i class="pi pi-check" style="color:  green; font-size: 124px;"></i>
    </div>

    <div class="mt-4" style="color:  green;font-size: 42px;display: flex ; justify-content: center;text-align: center;">
      Ödemeniz Başarıyla Alındı

    </div>

  </div>
</div>

<p-dialog *ngIf="onProcess&&html" [(visible)]="onProcess" [modal]="true" [style]="{ width: '25rem' }">

  <iframe style="width: 100%;height: 500px;" [src]="html"></iframe>


</p-dialog>